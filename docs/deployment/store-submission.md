# **Store Submission Guide for D365 DOM Style Injector Extension**

This guide provides a comprehensive overview of the process for submitting the D365 DOM Style Injector Extension (both Admin and User versions) to the Chrome Web Store and Microsoft Edge Add-ons store. It covers prerequisites, manual steps, and integration with the automated CI/CD pipeline.

## **Table of Contents**

1. [Overview](#bookmark=id.q0cc1owakcce)  
2. [Prerequisites](#bookmark=id.ystg3at32dpa)  
   * [Developer Accounts](#bookmark=id.geci85wu7j2d)  
   * [Store Configuration Files](#bookmark=id.u9vt2wykkzlx)  
   * [Extension Assets](#bookmark=id.17jn8arpswoi)  
3. [Manual Submission Process (First Time)](#bookmark=id.4haa58xj79zd)  
   * [Chrome Web Store](#bookmark=id.kogpxsxm68tp)  
   * [Microsoft Edge Add-ons](#bookmark=id.9xqovofncnha)  
4. [Automated Submission with CI/CD](#bookmark=id.xtil5gtr1xg2)  
   * [Chrome Web Store Automation](#bookmark=id.c8zcfoixfay)  
   * [Microsoft Edge Add-ons Automation](#bookmark=id.kqfd52a8mvcb)  
5. [Versioning and Updates](#bookmark=id.63bnaepdepg6)  
6. [Listing Information and Best Practices](#bookmark=id.db2ewvc87iy)  
7. [Troubleshooting Submission Issues](#bookmark=id.wrgy4go28ojv)

## **1\. Overview**

Submitting a browser extension to official stores involves adhering to platform-specific guidelines, providing accurate metadata, and passing review processes. This document details the steps for both initial manual submission (often required for setting up automated APIs) and subsequent automated updates via CI/CD.

## **2\. Prerequisites**

### **Developer Accounts**

* **Chrome Web Store Developer Account:** You need an active developer account for the Chrome Web Store. This typically involves a one-time registration fee.  
* **Microsoft Partner Center Account:** For Edge Add-ons, you need a Microsoft Partner Center account with access to the "Microsoft Edge Add-ons" dashboard.

### **Store Configuration Files**

Ensure the following configuration files are properly filled out with your specific IDs and settings:

* config/store-configs/chrome-store.json  
* config/store-configs/edge-store.json

### **Extension Assets**

Prepare all required visual assets and descriptive texts:

* **Icons:** 16x16, 48x48, 128x128 PNGs (e.g., in src/icons/, user-version/icons/).  
* **Promotional Images:** Specific sizes and formats for promotional tiles and banners for each store (check store guidelines).  
* **Screenshots:** Representative screenshots of the extension in action.  
* **Descriptions:** Short and full descriptions for both Admin and User versions.  
* **Privacy Policy URL:** A link to your organization's privacy policy.  
* **Support URL:** A link to your support page or contact information.  
* **Website URL:** A link to your project's or company's website.

## **3\. Manual Submission Process (First Time)**

For the very first submission of an extension, you typically need to go through the web console to set up the listing and obtain the necessary IDs for automation.

### **Chrome Web Store**

1. **Access Dashboard:** Go to the [Chrome Web Store Developer Dashboard](https://chrome.google.com/webstore/developer/dashboard).  
2. **Add New Item:** Click "Add new item".  
3. **Upload Package:** Upload the .zip file generated by your build process (e.g., dist/admin/admin-version.zip or dist/user/user-version.zip).  
4. **Fill Out Listing Details:**  
   * **Store Listing:** Provide descriptions (short/full), categories, languages, website, privacy policy, support URLs.  
   * **Graphics:** Upload icons, screenshots, and promotional tiles.  
   * **Permissions:** Confirm the permissions shown match your manifest.json.  
   * **Privacy Practices:** Declare how user data is handled.  
   * **Distribution:** Set visibility and target regions.  
5. **Review and Submit:** Carefully review all details and submit for review.  
6. **Note Extension ID:** Once created, you'll get an Extension ID (e.g., abcdefghijklmnopqrstuvwxyz1234567890abcdef). Update this in config/store-configs/chrome-store.json.  
7. **Generate API Credentials:** Set up OAuth credentials for automated uploads. This involves creating a service account and generating a refresh token.

### **Microsoft Edge Add-ons**

1. **Access Dashboard:** Go to the [Microsoft Partner Center](https://partner.microsoft.com/dashboard/home) and navigate to the "Microsoft Edge Add-ons" section.  
2. **Create New Product:** Click "Create new product".  
3. **Basic Details:** Provide a product name and select the product type (Extension).  
4. **Package Upload:** Upload the .zip file (e.g., dist/admin/admin-version.zip or dist/user/user-version.zip).  
5. **Listing Information:**  
   * **Properties:** Category, privacy policy, support info.  
   * **Store Listings:** Titles, descriptions, screenshots for each locale.  
   * **Availability:** Pricing (if applicable), markets.  
   * **Declarations:** Content compliance, privacy practices.  
6. **Submission:** Submit for review.  
7. **Note Product ID:** Once the submission is initiated, you'll get a Product ID. Update this in config/store-configs/edge-store.json.  
8. **Setup API Integration:** For automation, you'll configure an Azure AD application and grant it permissions to publish to your Partner Center account. This provides the client ID, client secret, and tenant ID for automated access.

## **4\. Automated Submission with CI/CD**

Once the initial manual setup is complete and you have the necessary IDs and API credentials configured as GitHub Secrets, the automated CI/CD workflows can handle subsequent updates.

* **Trigger:** The cd-chrome-store.yml and cd-edge-store.yml workflows are configured to run when a new Git tag (e.g., v1.0.0) is pushed to the main branch.  
* **Process:**  
  1. The workflow checks out the code.  
  2. It downloads the .zip artifacts (admin and user versions) that were generated and archived by the ci.yml workflow.  
  3. Using browser-specific publishing tools (e.g., web-ext-submit for Chrome, Microsoft's official CLI for Edge), it authenticates with the store APIs using the stored secrets.  
  4. It uploads the new extension package(s) and applies metadata from your chrome-store.json or edge-store.json.  
  5. It initiates the submission process, potentially setting the extension to auto-publish if configured.

## **5\. Versioning and Updates**

* **Semantic Versioning:** Use semantic versioning (e.g., MAJOR.MINOR.PATCH) for the extension (manifest.json version field).  
* **Automated Version Bump:** Use the scripts/version-bump.js script to increment the version number before a release.  
* **Release Notes:** Ensure your release notes in the store configuration files are updated with each new version.  
* **Rollbacks:** Familiarize yourself with the rollback options provided by each store in case a published version has critical issues.

## **6\. Listing Information and Best Practices**

* **Clarity:** Ensure your descriptions clearly differentiate between the Admin and User versions.  
* **Keywords:** Use relevant keywords in your descriptions and titles to improve discoverability.  
* **Compelling Screenshots:** Use high-quality, clear screenshots that demonstrate the extension's value.  
* **Regular Updates:** Provide consistent updates to address bugs, add features, and maintain compatibility.  
* **Response to Reviews:** Actively monitor and respond to user reviews and support requests.

## **7\. Troubleshooting Submission Issues**

* **API Errors:** Check the logs of your CI/CD workflow runs for specific error messages from the store APIs.  
* **Policy Violations:** If your submission is rejected, carefully read the policy violation details provided by the store. Common reasons include misused permissions, misleading descriptions, or violations of branding guidelines.  
* **Asset Requirements:** Double-check that all image assets meet the exact size, format, and content requirements for each store.  
* **Manifest Errors:** Ensure your manifest.json is valid and adheres to Manifest V3 specifications.